# yarn

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * yarn
 * 
 * 
 * 全新的命令管理
 */


yarn 是由 Facebook，Google，Exponent，Tilde 联合推出的一个新的 JS 包管理工具

它仍然使用 npm 的 registry，但它提供了全新的 CLI 对包进行管理


//-------------------------------------------------------------------------------------------------------------------//


/**
 * npm 之前包含的问题
 * 
 * 
 */

1) 依赖陌路嵌套层次深: 

    过去 npm 的依赖是嵌套的，这在 window 上是一个极大的问题( 以前 window 系统无法支持超过 256 字符的路径 )


2) 下载速度慢: 

    由于嵌套层级问题，所以npm 对包的下载只能串行( 只有当前层级下载完，才能下载下级路径中的文件 )，导致带宽资源无法被完全利用
    
    由于嵌套层级问题，多个相同版本的包被重复下载


3) 控制台输出繁杂: 

    过去，npm 安装包时，每安装一个依赖，就会输出依赖的详细信息，导致一次安装有大量的信息输出到控制台，遇到错误难以查找
    

4) 工程移植问题:
    
    由于 npm 的版本依赖可是是模糊的，可能会导致工程移植后，最终的依赖版本不一致


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * yarn 解决的问题
 * 
 * 
 */

1) 使用扁平的目录结构

2) 并行下载

3) 使用本地缓存

4) 控制台仅输出关键信息

5) 使用 yarn 文件记录确切依赖


// yarn 所优化的问题

1) 增加了部分强大功能

2) 使命令更语义化

3) 本地安装的 CLI 工具使用 yarn 直接启动

4) 将全局安装的目录当作一个普通的工程，生成 package.json 文件( 便于全局工程安装或移植 )


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * npm 迭代优化
 * 
 * 
 */

1) 目录扁平化

2) 并行下载

3) 使用本地缓存

4) 使用 package-lock 记录确切依赖

5) 优化命令语义化

6) 内置 npx，启动本地 CLI 工具

7) 极大简化控制台输出


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## Command Line

#### init

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 初始化
 * 
 * 
 */

yarn init [--yes/-y]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### install

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 添加指定包
 * 
 * 
 */

yarn [global] add packageName [--dev/-D] [--exact/-E]


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 安装  package.json 中所有的依赖
 * 
 * 
 */

yarn insall [--production/--prod]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### script-command

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 运行 shell 脚本
 * 
 * 
 */

yarb run [script-name]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### search

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 查看 bin 目录
 * 
 * 
 */

yarn [global] bin


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 查询包信息
 * 
 * 
 */

yarn info packageName [subInfo]


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 列举已安装依赖
 * 
 * 
 * yarn 的 list 命令必 npm 的信息更加丰富( 包括顶级目录结构，每个包的依赖版本号 )
 */

yarn [global] list [--depth=Dependency: number]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### update

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 列举需要更新的包
 * 
 * 
 */

yarn outedated


//- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -//


/**
 * 更新包
 * 
 * 
 */

yarn [global] upgrade packageName


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### uninstall

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 卸载包
 * 
 * 
 */

yarn remoove [package]


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

## Private command of yarn

#### yarn check

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 验证 package.json 的依赖记录 和 lock文件 的是否一直
 * 
 * 
 * 用于验证用户是否手动篡改 package.json 
 */

yarn chech


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### yarn audit

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 检查本地安装的包有哪些漏洞
 * 
 * 
 * 以表格的形式展示
 */


// 漏洞级别

INFO                // 信息

LOW                 // 低级别

MODERATTE           // 中级别

HIGH                // 高级别

CRITICAL            // 关键级别


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### yarn why

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 获取指定依赖包的依赖关系
 * 
 * 
 */

yran why packageName


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```

#### yarn create

``` javascript
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


/**
 * 利用 yarn 一步完成安装和搭建工程结构
 * 
 * 
 * 脚手架: 使用命令搭建一个工程结构
 */


yarn create react-app my-app                    // 一步完成安装和搭建


// yarn global add create-reactt-app            // 全局安装脚手架工具
// 
// creeate-react-app my-app                     // 使用全局脚手架命令搭建脚手架


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
```